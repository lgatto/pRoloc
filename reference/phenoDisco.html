<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Runs the phenoDisco algorithm. — phenoDisco • pRoloc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Runs the phenoDisco algorithm. — phenoDisco"><meta name="description" content="phenoDisco is a semi-supervised iterative approach to
detect new protein clusters."><meta property="og:description" content="phenoDisco is a semi-supervised iterative approach to
detect new protein clusters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pRoloc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.47.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-pRoloc-tutorial.html">Using pRoloc for spatial proteomics data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/v02-pRoloc-ml.html">Machine learning techniques available in pRoloc</a></li>
    <li><a class="dropdown-item" href="../articles/v03-pRoloc-bayesian.html">Bayesian Analysis of Spatial Proteomics data using pRoloc</a></li>
    <li><a class="dropdown-item" href="../articles/v04-pRoloc-goannotations.html">Annotating spatial proteomics data</a></li>
    <li><a class="dropdown-item" href="../articles/v05-pRoloc-transfer-learning.html">A transfer learning algorithm for spatial proteomics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/pRoloc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Runs the <code>phenoDisco</code> algorithm.</h1>
      <small class="dont-index">Source: <a href="https://github.com/lgatto/pRoloc/blob/master/R/phenodisco.R" class="external-link"><code>R/phenodisco.R</code></a></small>
      <div class="d-none name"><code>phenoDisco.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>phenoDisco</code> is a semi-supervised iterative approach to
detect new protein clusters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">phenoDisco</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  fcol <span class="op">=</span> <span class="st">"markers"</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  GS <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  allIter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  ndims <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  modelNames <span class="op">=</span> <span class="fu">mclust.options</span><span class="op">(</span><span class="st">"emModelNames"</span><span class="op">)</span>,</span>
<span>  G <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,</span>
<span>  <span class="va">BPPARAM</span>,</span>
<span>  <span class="va">tmpfile</span>,</span>
<span>  <span class="va">seed</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCA"</span>, <span class="st">"t-SNE"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class <code>MSnSet</code>.</p></dd>


<dt id="arg-fcol">fcol<a class="anchor" aria-label="anchor" href="#arg-fcol"></a></dt>
<dd><p>A <code>character</code> indicating the organellar markers
column name in feature meta-data. Default is <code>markers</code>.</p></dd>


<dt id="arg-times">times<a class="anchor" aria-label="anchor" href="#arg-times"></a></dt>
<dd><p>Number of runs of tracking. Default is 100.</p></dd>


<dt id="arg-gs">GS<a class="anchor" aria-label="anchor" href="#arg-gs"></a></dt>
<dd><p>Group size, i.e how many proteins make a group. Default
is 10 (the minimum group size is 4).</p></dd>


<dt id="arg-alliter">allIter<a class="anchor" aria-label="anchor" href="#arg-alliter"></a></dt>
<dd><p><code>logical</code>, defining if predictions for all
iterations should be saved. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Significance level for outlier detection. Default is
0.05.</p></dd>


<dt id="arg-ndims">ndims<a class="anchor" aria-label="anchor" href="#arg-ndims"></a></dt>
<dd><p>Number of principal components to use as input for
the disocvery analysis. Default is 2. Added in version 1.3.9.</p></dd>


<dt id="arg-modelnames">modelNames<a class="anchor" aria-label="anchor" href="#arg-modelnames"></a></dt>
<dd><p>A vector of characters indicating the models to
be fitted in the EM phase of clustering using
<code>Mclust</code>. The help file for <code><a href="https://mclust-org.github.io/mclust/reference/mclustModelNames.html" class="external-link">mclust::mclustModelNames</a></code>
describes the available models. Default model names are
<code>c("EII", "VII", "EEI", "VEI", "EVI", "VVI", "EEE",
"EEV", "VEV", "VVV")</code>, as returned by
<code>mclust.options("emModelNames")</code>. Note that using all
these possible models substantially increases the running
time. Legacy models are <code>c("EEE","EEV","VEV","VVV")</code>,
i.e. only ellipsoidal models.</p></dd>


<dt id="arg-g">G<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>An integer vector specifying the numbers of mixture
components (clusters) for which the BIC is to be
calculated. The default is <code>G=1:9</code> (as in <code>Mclust</code>).</p></dd>


<dt id="arg-bpparam">BPPARAM<a class="anchor" aria-label="anchor" href="#arg-bpparam"></a></dt>
<dd><p>Support for parallel processing using the
<code>BiocParallel</code> infrastructure. When missing (default),
the default registered <code>BiocParallelParam</code> parameters are
used. Alternatively, one can pass a valid
<code>BiocParallelParam</code> parameter instance: <code>SnowParam</code>,
<code>MulticoreParam</code>, <code>DoparParam</code>, ... see the
<code>BiocParallel</code> package for details. To revert to the
origianl serial implementation, use <code>NULL</code>.</p></dd>


<dt id="arg-tmpfile">tmpfile<a class="anchor" aria-label="anchor" href="#arg-tmpfile"></a></dt>
<dd><p>An optional <code>character</code> to save a temporary
<code>MSnSet</code> after each iteration. Ignored if missing. This
is useful for long runs to track phenotypes and possibly kill
the run when convergence is observed. If the run completes,
the temporary file is deleted before returning the final
result.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An optional <code>numeric</code> of length 1 specifing the
random number generator seed to be used. Only relevant when
executed in serialised mode with <code>BPPARAM = NULL</code>. See
<code>BPPARAM</code> for details.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, indicating if messages are to be printed
out during execution of the algorithm.</p></dd>


<dt id="arg-dimred">dimred<a class="anchor" aria-label="anchor" href="#arg-dimred"></a></dt>
<dd><p>A <code>characater</code> defining which of Principal
Component Analysis (<code>"PCA"</code>) or t-Distributed Stochastic
Neighbour Embedding (<code>"t-SNE"</code>) should be use to reduce
dimensions prior to running phenoDisco novelty detection.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the dimensionality
reduction method. For both PCA and t-SNE, the data is scaled
and centred by default, and these parameters (<code>scale</code> and
<code>centre</code> for PCA, and <code>pca_scale</code> and
<code>pca_center</code> for t-SNE can't be set). When using t-SNE
however, it is important to tune the perplexity and max
iterations parameters. See the <em>Dimensionality reduction</em>
section in the pRoloc vignette for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An instance of class <code>MSnSet</code> containing the
    <code>phenoDisco</code> predictions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The algorithm performs a phenotype discovery analysis as described
in Breckels et al. Using this approach one can identify putative
subcellular groupings in organelle proteomics experiments for more
comprehensive validation in an unbiased fashion. The method is
based on the work of Yin et al. and used iterated rounds of
Gaussian Mixture Modelling using the Expectation Maximisation
algorithm combined with a non-parametric outlier detection test to
identify new phenotype clusters.</p>
<p>One requires 2 or more classes to be labelled in the data and at a
very minimum of 6 markers per class to run the algorithm.  The
function will check and remove features with missing values using
the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterNA</a></code> method.</p>
<p>A parallel implementation, relying on the <code>BiocParallel</code>
package, has been added in version 1.3.9. See the <code>BPPARAM</code>
arguent for details.</p>
<p>Important: Prior to version 1.1.2 the row order in the output was
different from the row order in the input. This has now been fixed
and row ordering is now the same in both input and output objects.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Yin Z, Zhou X, Bakal C, Li F, Sun Y, Perrimon N, Wong
    ST. Using iterative cluster merging with improved gap
    statistics to perform online phenotype discovery in the
    context of high-throughput RNAi screens. BMC
    Bioinformatics. 2008 Jun 5;9:264.  PubMed PMID: 18534020.</p>
<p>Breckels LM, Gatto L, Christoforou A, Groen AJ, Lilley KS and
Trotter MWB.  The Effect of Organelle Discovery upon Sub-Cellular
Protein Localisation.  J Proteomics. 2013 Aug 2;88:129-40. doi:
10.1016/j.jprot.2013.02.019. Epub 2013 Mar 21.  PubMed PMID:
23523639.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lisa M. Breckels &lt;lms79@cam.ac.uk&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lgatto/pRolocdata" class="external-link">pRolocdata</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tan2009r1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pdres</span> <span class="op">&lt;-</span> <span class="fu">phenoDisco</span><span class="op">(</span><span class="va">tan2009r1</span>, fcol <span class="op">=</span> <span class="st">"PLSDA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="getPredictions.html">getPredictions</a></span><span class="op">(</span><span class="va">pdres</span>, fcol <span class="op">=</span> <span class="st">"pd"</span>, scol <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot2D.html">plot2D</a></span><span class="op">(</span><span class="va">pdres</span>, fcol <span class="op">=</span> <span class="st">"pd"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## to pre-process the data with t-SNE instead of PCA</span></span></span>
<span class="r-in"><span><span class="va">pdres</span> <span class="op">&lt;-</span> <span class="fu">phenoDisco</span><span class="op">(</span><span class="va">tan2009r1</span>, fcol <span class="op">=</span> <span class="st">"PLSDA"</span>, dimred <span class="op">=</span> <span class="st">"t-SNE"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Lisa Breckels, Oliver Crook.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

