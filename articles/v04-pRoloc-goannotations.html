<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Annotating spatial proteomics data • pRoloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Annotating spatial proteomics data">
<meta property="og:description" content="pRoloc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pRoloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.43.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01-pRoloc-tutorial.html">Using pRoloc for spatial proteomics data analysis</a>
    </li>
    <li>
      <a href="../articles/v02-pRoloc-ml.html">Machine learning techniques available in pRoloc</a>
    </li>
    <li>
      <a href="../articles/v03-pRoloc-bayesian.html">Bayesian Analysis of Spatial Proteomics data using pRoloc</a>
    </li>
    <li>
      <a href="../articles/v04-pRoloc-goannotations.html">Annotating spatial proteomics data</a>
    </li>
    <li>
      <a href="../articles/v05-pRoloc-transfer-learning.html">A transfer learning algorithm for spatial proteomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lgatto/pRoloc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Annotating spatial proteomics data</h1>
                        <h4 data-toc-skip class="author">Lisa M.
Breckels</h4>
            <address class="author_afil">
      Computational Proteomics Unit, Cambridge,
UK<br><h4 data-toc-skip class="author">Laurent
Gatto</h4>
            <address class="author_afil">
      de Duve Institute, UCLouvain, Belgium<br><small class="dont-index">Source: <a href="https://github.com/lgatto/pRoloc/blob/HEAD/vignettes/v04-pRoloc-goannotations.Rmd" class="external-link"><code>vignettes/v04-pRoloc-goannotations.Rmd</code></a></small>
      <div class="hidden name"><code>v04-pRoloc-goannotations.Rmd</code></div>

    </address>
</address>
</div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div class="section level2">
<h2 class="unnumbered" id="foreword">Foreword<a class="anchor" aria-label="anchor" href="#foreword"></a>
</h2>
<p>This document walks users through a typical pipeline for adding
annotation information to spatial proteomics data. For a general
practical introduction to pRoloc and spatial proteomics data analysis,
readers are referred to the tutorial, available using
<code>vignette("pRoloc-tutorial", package = "pRoloc")</code>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Exploring protein annotations and defining sub-cellular localisation
markers (i.e. known residents of a specific sub-cellular niche in a
species, under a condition of interest) play important roles in the
analysis of spatial proteomics data. The latter is essential for
downstream supervised machine learning (ML) classification for protein
localisation prediction (see
<code>vignette("pRoloc-tutorial", package = "pRoloc")</code> and
<code>vignette("pRoloc-ml", package = "pRoloc")</code> for information
on available ML methods) and the former is interesting for initial
biological interpretation through matching annotations to the data
structure.</p>
<p>Robust protein-localisation prediction is reliant on markers that
reflect the true sub-cellular diversity of the multivariate data. The
validity of markers is generally assured by expert curation. This can be
time consuming and difficult owing to the limited number of marker
proteins that exist in databases and elsewhere. The Gene Ontology (GO)
database, and in particular the cellular compartment (CC) namespace
provide a good starting point for protein annotation and marker
definition. Nevertheless, automatic extraction from databases, and in
particular GO CC, is only a first step in sub-cellular localisation
analysis and requires additional curation to counter unreliable
annotation based on data that is inaccurate or out of context for the
biological question under investigation.</p>
<p>To facilitate the above, we have developed an annotation retrieval
and management system that provides a flexible framework for the
exploration of the sub-cellular proteomics data. We have developed a
method to correlate annotation information with the multivariate data
space to identify densely annotated regions and assess cluster
tightness. Given a set of proteins that share some property e.g. a
specified GO term, a k-means clustering is used to fit the data (testing
<code>k = 1:5</code>) and then for each number of <code>k</code>
components tested, all pairwise Euclidean distances are calculated per
component, and then normalised. The minimum mean normalised distance is
then extracted and used as a measure of cluster tightness. This is
repeated for all protein/annotation sets. These sets are then ranked
according to minimum mean normalised distance and then can be displayed
and explored using the <em><a href="https://bioconductor.org/packages/3.19/pRolocGUI" class="external-link">pRolocGUI</a></em>
package.</p>
<p>In this vignette we present a step-by-step guide showing users how to
(1) how to add protein annotations, here we use the GO database as an
example, and (2) rank and order information (e.g. GO terms) according to
their correlation with the data structure, for the extraction of optimal
data specific annotated clusters.</p>
</div>
<div class="section level2">
<h2 id="loading-the-data">Loading the data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>We will demonstrate our pipeline for adding and ranking annotation
information using a LOPIT experiment on Pluripotent Mouse Embryonic
stems (<a href="http://www.nature.com/ncomms/2016/160112/ncomms9992/full/ncomms9992.html" class="external-link">Christoforou
et al 2016</a>), available and documented in the <em><a href="https://bioconductor.org/packages/3.19/pRolocdata" class="external-link">pRolocdata</a></em>
data package as <code>hyperlopit2015</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lgatto/pRoloc" class="external-link">"pRoloc"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lgatto/pRolocdata" class="external-link">"pRolocdata"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Subset data for markers for example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hyperLOPIT2015"</span><span class="op">)</span></span>
<span><span class="va">hyperLOPIT2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/markerMSnSet.html">markerMSnSet</a></span><span class="op">(</span><span class="va">hyperLOPIT2015</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-sub-cellular-localisation-information">Adding sub-cellular localisation information<a class="anchor" aria-label="anchor" href="#adding-sub-cellular-localisation-information"></a>
</h2>
<p>All GO terms associated to proteins that appear in the dataset are
retrieved and used to create a binary matrix where a 1 (0) at position
<span class="math inline">\((i,j)\)</span> indicates that term <span class="math inline">\(j\)</span> has (not) been used to annotate feature
<span class="math inline">\(i\)</span>. This matrix is appended and
stored in the feature data slot of the <code>MSnSet</code> dataset using
the <code>addGoAnnotations</code> function. We first however need to
prepare annotation parameters that will enable us to query the Biomart
repository using the package, from where we are able to retrieve GO
terms. The specific Biomart repository and query will depend on the
species under study and the type of features. This can be set using the
<code>setAnnotationParams</code> function.</p>
<p>In the code chunk below we set the annotation parameters for the
<code>hyperLOPIT2015</code> dataset. As this species used was mouse and
the <code>featureNames</code> of the <code>hyperLOPIT2015</code> dataset
are Uniprot accession numbers the input to the function is defined as
<code>inputs = c("Mus musculus", "UniProtKB/Swiss-Prot ID")</code>. See
<code><a href="../reference/AnnotationParams-class.html">?setAnnotationParams</a></code> for details.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnnotationParams-class.html">setAnnotationParams</a></span><span class="op">(</span>inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mouse genes"</span>,</span>
<span>                                         <span class="st">"UniProtKB/Swiss-Prot ID"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using species Mouse genes (GRCm39)</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Ensembl will soon enforce the use of https.</span></span>
<span><span class="co">## Ensure the 'host' argument includes "https://"</span></span></code></pre>
<pre><code><span><span class="co">## Using feature type UniProtKB/Swiss-Prot ID(s) [e.g. A0A087WPF7]</span></span></code></pre>
<pre><code><span><span class="co">## Connecting to Biomart...</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Ensembl will soon enforce the use of https.</span></span>
<span><span class="co">## Ensure the 'host' argument includes "https://"</span></span></code></pre>
<p>Now the parameters for the search have been defined we can use the
<code>addGoAnnotations</code> function to add a GO information matrix to
the <code>featureData</code> slot of the dataset. The
<code>addGoAnnotations</code> function takes a <code>MSnSet</code>
instance as input (from which the <code>featureNames</code> will be
extracted) and it downloads the CC terms (the default, biological
process and the molecular function namespaces are also supported) found
for each protein in the dataset. The output <code>MSnSet</code> has the
CC term binary matrix appended to the <code>fData</code>, by default
this is called <code>GOAnnotations</code> (and changed using the
<code>fcol</code> argument).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addGoAnnotations.html">addGoAnnotations</a></span><span class="op">(</span><span class="va">hyperLOPIT2015</span>, <span class="va">params</span>,</span>
<span>                       namespace <span class="op">=</span> <span class="st">"cellular_component"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fvarLabels</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "entry.name"                "protein.description"      </span></span>
<span><span class="co">##  [3] "peptides.rep1"             "peptides.rep2"            </span></span>
<span><span class="co">##  [5] "psms.rep1"                 "psms.rep2"                </span></span>
<span><span class="co">##  [7] "phenodisco.input"          "phenodisco.output"        </span></span>
<span><span class="co">##  [9] "curated.phenodisco.output" "markers"                  </span></span>
<span><span class="co">## [11] "svm.classification"        "svm.score"                </span></span>
<span><span class="co">## [13] "svm.top.quartile"          "final.assignment"         </span></span>
<span><span class="co">## [15] "first.evidence"            "curated.organelles"       </span></span>
<span><span class="co">## [17] "cytoskeletal.components"   "trafficking.proteins"     </span></span>
<span><span class="co">## [19] "protein.complexes"         "signalling.cascades"      </span></span>
<span><span class="co">## [21] "oct4.interactome"          "nanog.interactome"        </span></span>
<span><span class="co">## [23] "sox2.interactome"          "cell.surface.proteins"    </span></span>
<span><span class="co">## [25] "markers2015"               "TAGM"                     </span></span>
<span><span class="co">## [27] "GOAnnotations"</span></span></code></pre>
<p>The <code>addGoAnnotations</code> function by defualt does not do any
filtering of the terms evidence codes unless specified in the
<code>evidence</code> argument, see <code><a href="../reference/addGoAnnotations.html">?addGoAnnotations</a></code> for
more details.</p>
<p>With many well-annotated species and datasets containing typically
thousands of proteins, we often find many CC terms, of which many may
not be particularly meaningful. These such terms can be filtered out
using the <code>filerMinMarkers</code> and <code>filterMaxMarkers</code>
functions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Next we filter the GO term matrix removing any terms that have</span></span>
<span><span class="co">## have less than `n` proteins or greater than `p` % of total proteins</span></span>
<span><span class="co">## in the dataset (this removes terms that only have very few proteins</span></span>
<span><span class="co">## and very general terms)</span></span>
<span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterMinMarkers.html">filterMinMarkers</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterMaxMarkers.html">filterMaxMarkers</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="correlating-and-ordering-annotation-information">Correlating and ordering annotation information<a class="anchor" aria-label="anchor" href="#correlating-and-ordering-annotation-information"></a>
</h2>
<p>Now we have extracted and filtered annotation information for our
dataset we re-order the <code>GOAnnotations</code> matrix of terms
according to their correlation with the dataset structure. To do this we
use the <code>orderGoAnnotations</code> function.</p>
<p>For each piece of annotation information, e.g. for each GO CC term in
the matrix, the function:</p>
<ol style="list-style-type: decimal">
<li>Extracts all instances (proteins) with the specified term</li>
<li>Fits <code>k</code> component clusters to this subset using the
<code>kmeans</code> algorithm (the default to test is
<code>k = 1:5</code>).</li>
<li>Calculates all pairwise Euclidean distances per component
cluster</li>
<li>Normalises each component by the cubed root of the number of
instances per component (this was set heuristically through individual
tests and can be set using the argument <code>p</code>)</li>
<li>Orders the annotation information in <code>GOAnnotations</code>
according to the minimum normalised Euclidean distance.</li>
</ol>
<p>We find that high density clusters have the low mean normalised
Euclidean distances. In the below chunk we test try fitting
<code>k = 1:3</code> component clusters per term and normalise by
<code>p = 1/3</code>. The ordered terms can be displayed using the
<code>pRolocVis</code> function in the <code>pRolocGUI</code>
package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract markers can use n to specify to select top n terms</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orderGoAnnotations.html">orderGoAnnotations</a></span><span class="op">(</span><span class="va">cc</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating GO cluster densities</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"pRolocGUI"</span><span class="op">)</span></span>
<span><span class="fu">pRolocVis</span><span class="op">(</span><span class="va">res</span>, fcol <span class="op">=</span> <span class="st">"GOAnnotations"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="examining-distances">Examining distances<a class="anchor" aria-label="anchor" href="#examining-distances"></a>
</h3>
<p>Instead of using the <code>orderGoAnnotations</code> function which
is a wrapper for steps 1 - 5 above, it is possible to calculate the
Euclidean distances manually using the <code>clustDist</code> function.
The input is a <code>MSnSet</code> dataset with the matrix of markers
e.g. <code>GOAnnotations</code> appended to the <code>fData</code> slot.
The output is a <code>"ClustDistList"</code>. The
<code>"ClustDist"</code> and <code>"ClustDistList"</code> class
summarises the algorithm information such as the number of k’s tested
for the kmeans, and mean and normalised pairwise Euclidean distances per
numer of component clusters tested.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Now calculate distances</span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustDist.html">clustDist</a></span><span class="op">(</span><span class="va">cc</span>, fcol <span class="op">=</span> <span class="st">"GOAnnotations"</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class "ClustDist"</span></span>
<span><span class="co">## fcol =  GOAnnotations </span></span>
<span><span class="co">##  term =  GO:0005856 </span></span>
<span><span class="co">##  id =  cytoskeleton </span></span>
<span><span class="co">##  nrow =  32 </span></span>
<span><span class="co">## k's tested: 1 2 3 </span></span>
<span><span class="co">##   Size:  32 </span></span>
<span><span class="co">##   Size:  24 </span></span>
<span><span class="co">##   Size:  15, 11 </span></span>
<span><span class="co">## Clusters info:</span></span>
<span><span class="co">##       ks.mean    mean ks.norm     norm</span></span>
<span><span class="co">## k = 1       1  0.4208       1  0.13253</span></span>
<span><span class="co">## k = 2       1 *0.2104       1 *0.07293</span></span>
<span><span class="co">## k = 3       2  0.2181       2  0.09381</span></span></code></pre>
<p>We can use the <code>plotClustDist</code> and
<code>plotComponents</code> to visualise these results.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot normalised distances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dd</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="v04-pRoloc-goannotations_files/figure-html/visualiseRes-1.png" width="1152"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Examine kmeans clustering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">cc</span><span class="op">)</span></span></code></pre></div>
<p><img src="v04-pRoloc-goannotations_files/figure-html/visualiseRes-2.png" width="1152"></p>
<p>The output of <code>plotClustDist</code> is a boxplot of the
normalised distances per term and the output of
<code>plotComponents</code> is a set of principal components analysis
(PCA) plots, one for each <code>k</code> tested, highlighting the
component clusters found according to the kmeans algorithm.</p>
<p>The <code>getNormDist</code> function can be used to extract a
<code>vector</code> of normalised distances. Which can then be used to
rank and order the terms in the <code>GOAnnotations</code> matrix, as
per the code chunk below.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Normalise by n^1/3</span></span>
<span><span class="va">minDist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getNormDist.html">getNormDist</a></span><span class="op">(</span><span class="va">dd</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Get new order according to lowest distance</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">minDist</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Re-order `GOAnnotations` matrix in `fData`</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span><span class="op">$</span><span class="va">GOAnnotations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span><span class="op">$</span><span class="va">GOAnnotations</span><span class="op">[</span>, <span class="va">o</span><span class="op">]</span></span></code></pre></div>
<p>Finally, we can use the <code>pRolocVis</code> function in
<code>pRolocGUI</code> to visualise our clusters.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pRolocVis</span><span class="op">(</span><span class="va">cc</span>, fcol <span class="op">=</span> <span class="st">"GOAnnotations"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent Gatto, Lisa Breckels, Oliver Crook.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
