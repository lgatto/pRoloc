<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Pairwise Distance Computation for Protein Information Sets — clustDist • pRoloc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pairwise Distance Computation for Protein Information Sets — clustDist"><meta name="description" content="This function computes the mean (normalised) pairwise
distances for pre-defined sets of proteins."><meta property="og:description" content="This function computes the mean (normalised) pairwise
distances for pre-defined sets of proteins."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pRoloc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.45.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-pRoloc-tutorial.html">Using pRoloc for spatial proteomics data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/v02-pRoloc-ml.html">Machine learning techniques available in pRoloc</a></li>
    <li><a class="dropdown-item" href="../articles/v03-pRoloc-bayesian.html">Bayesian Analysis of Spatial Proteomics data using pRoloc</a></li>
    <li><a class="dropdown-item" href="../articles/v04-pRoloc-goannotations.html">Annotating spatial proteomics data</a></li>
    <li><a class="dropdown-item" href="../articles/v05-pRoloc-transfer-learning.html">A transfer learning algorithm for spatial proteomics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/pRoloc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pairwise Distance Computation for Protein Information Sets</h1>
      <small class="dont-index">Source: <a href="https://github.com/lgatto/pRoloc/blob/master/R/clusterdist-functions.R" class="external-link"><code>R/clusterdist-functions.R</code></a></small>
      <div class="d-none name"><code>clustDist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the mean (normalised) pairwise
distances for pre-defined sets of proteins.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clustDist</span><span class="op">(</span><span class="va">object</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, fcol <span class="op">=</span> <span class="st">"GOAnnotations"</span>, n <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">seed</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class <code>"<a href="https://lgatto.github.io/MSnbase/reference/MSnSet-class.html" class="external-link">MSnSet</a>"</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The number of clusters to try fitting to the protein set.
Default is <code>k = 1:5</code>.</p></dd>


<dt id="arg-fcol">fcol<a class="anchor" aria-label="anchor" href="#arg-fcol"></a></dt>
<dd><p>The feature meta-data containing matrix of protein sets/
marker definitions. Default is <code>GOAnnotations</code>.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>The minimum number of proteins per set. If protein sets
contain less than <code>n</code> instances they will be ignored.
Defualt is 5.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical defining whether a progress bar is displayed.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An optional seed for the random number generator.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An instance of <code>"<a href="ClustDistList-class.html">ClustDistList</a>"</code> containing
a <code>"<a href="ClustDist-class.html">ClustDist</a>"</code> instance for every protein set, which
summarises the algorithm information such as the number of k's tested
for the kmeans, and mean and normalised pairwise Euclidean distances
per numer of component clusters tested.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input to the function is a <code>MSnSet</code> dataset
containing a matrix appended to the feature data slot
identifying the membership of protein instances to
a pre-defined set(s) e.g. a specific Gene Ontology term etc.</p>
<p>For each protein set, the <code>clustDist</code> function (i)
extracts all instances belonging to the set, (ii) using
the <code>kmeans</code> algorithm fits and tests <code>k = c(1:5)</code>
(default) cluster components to each set, (iii) calculates
the mean pairwise distance for each <code>k</code> tested.</p>
<p>Note: currently distances are calcualted in Euclidean space,
but other distance metrics will be supported in the future).</p>
<p>The output is a <code>list</code> of <code>ClustDist</code> objects,
one per information cluster. The <code>ClustDist</code>
class summarises the algorithm information such as the number of k's
tested for the kmeans, and mean and normalised pairwise Euclidean
distances per numer of component clusters tested. See <code><a href="ClustDist-class.html">?ClustDist</a></code>
for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For class definitions see <code>"<a href="ClustDistList-class.html">ClustDistList</a>"</code>
and <code>"<a href="ClustDist-class.html">ClustDist</a>"</code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lisa Breckels</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lgatto/pRolocdata" class="external-link">pRolocdata</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dunkley2006</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="AnnotationParams-class.html">setAnnotationParams</a></span><span class="op">(</span>inputs <span class="op">=</span></span></span>
<span class="r-in"><span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Arabidopsis thaliana genes"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"Gene stable ID"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using species Arabidopsis thaliana genes (TAIR10)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ensembl will soon enforce the use of https.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Ensure the 'host' argument includes "https://"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using feature type Gene stable ID(s) [e.g. AT1G01010]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Connecting to Biomart...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ensembl will soon enforce the use of https.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Ensure the 'host' argument includes "https://"</span>
<span class="r-in"><span><span class="co">## add protein sets/annotation information</span></span></span>
<span class="r-in"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="addGoAnnotations.html">addGoAnnotations</a></span><span class="op">(</span><span class="va">dunkley2006</span>, <span class="va">par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## filter</span></span></span>
<span class="r-in"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="filterMinMarkers.html">filterMinMarkers</a></span><span class="op">(</span><span class="va">xx</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retaining 3 out of 79 in GOAnnotations</span>
<span class="r-in"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="filterMaxMarkers.html">filterMaxMarkers</a></span><span class="op">(</span><span class="va">xx</span>, p <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retaining 2 out of 3 in GOAnnotations</span>
<span class="r-in"><span><span class="co">## get distances for protein sets </span></span></span>
<span class="r-in"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu">clustDist</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="co">## plot clusters for first 'ClustDist' object </span></span></span>
<span class="r-in"><span><span class="co">## in the 'ClustDistList'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">xx</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="clustDist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## plot distances for all protein sets </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="clustDist-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## Extract normalised distances</span></span></span>
<span class="r-in"><span><span class="co">## Normalise by n^1/3</span></span></span>
<span class="r-in"><span><span class="va">minDist</span> <span class="op">&lt;-</span> <span class="fu"><a href="getNormDist.html">getNormDist</a></span><span class="op">(</span><span class="va">dd</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Get new order according to lowest distance</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">minDist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Re-order GOAnnotations </span></span></span>
<span class="r-in"><span><span class="fu">fData</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span><span class="op">$</span><span class="va">GOAnnotations</span> <span class="op">&lt;-</span> <span class="fu">fData</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span><span class="op">$</span><span class="va">GOAnnotations</span><span class="op">[</span>, <span class="va">o</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">pRolocVis</span><span class="op">(</span><span class="va">xx</span>, fcol <span class="op">=</span> <span class="st">"GOAnnotations"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Lisa Breckels, Oliver Crook.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

